{{/*
this: file
path: {{this.Package.Name}}/{{this.Name}}.next.h
*/}}

{{- /* Overrides "next/c/import" */ -}}
{{- define "c/import" -}}
#include "../{{.File.Package.Name}}/{{.File.Name}}.next.h"
{{- end -}}

{{- /* Overrides "next/c/struct": add method 'message_type' for each message after fields */ -}}
{{- define "c/struct" -}}
{{next .Doc}}typedef struct {
{{- next .Fields}}
} {{.Name}};

{{- if .Annotations.message.type}}
static inline int {{.Name}}_message_type() { return {{.Annotations.message.type}}; }
{{- end}}
{{- end -}}

{{- define "next/c/enum.member" -}}
{{next .Doc}}{{.Decl.Name}}_{{.Name}} = {{.Value}},{{next .Comment}}
{{- end -}}

{{head}}

{{next this}}